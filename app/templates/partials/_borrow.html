<section>
  <h2>Borrow / Return</h2>
  <div class="form-row">
    <input id="book_id" placeholder="Book ID">
    <button type="button" onclick="borrowBook()">Borrow</button>
  </div>
  <div id="borrow-result"></div>
</section>
<script>
// if borrowBook is not defined by app.js, provide fallback
if(typeof borrowBook === 'undefined'){
  async function borrowBook(){
    const bookId = document.getElementById('book_id').value;
    const resDiv = document.getElementById('borrow-result');
    resDiv.innerText = '';
    try{
      const resp = await fetch('/api/borrows', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({book_id: bookId})
      });
      const data = await resp.json();
      if(resp.status >= 400) resDiv.innerHTML = '<div class="message error">' + JSON.stringify(data) + '</div>';
      else resDiv.innerHTML = '<div class="message success">' + JSON.stringify(data) + '</div>';
    }catch(e){
      resDiv.innerHTML = '<div class="message error">Network error</div>';
    }
  }
}
</script>
